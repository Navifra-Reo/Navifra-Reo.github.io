---
title:  "Kinematics, Continuous Time Domain based MAPF"
excerpt: "Multi Robot Control"

categories:
  - Multi_Robot

tags:
  - [MAPF, CBS]

toc: true
toc_sticky: true
layout: post
use_math: true
 
date: 2024-03-24
last_modified_at: 2024-03-24
---

회사에서 개발을 하던 내용을 블로그에 써보려고 한다. 내가 맡고 있던 업무는 멀티로봇의 작업 스케줄링과, MAPF알고리즘의 연구 및 개발인데 이번 글에서는 이때까지 해온 MAPF 개발에 대해 작성해 보려고 한다.
<br>

# 현장에서의 경로탐색 문제 사항

기존의 MAPF알고리즘은 보통 단위시간 기반 알고리즘(CBS기반)이다. 즉 로봇이 다음노드로 이동하는데 걸리는 시간은 항상 동일하고, 로봇의 회전시간이나 감가속도는 고려되지 않는다. 물론 문제를 해결하기 위해서 문제를 추상화 하는것은 좋지만, 실제 상황과 너무 큰 차이가 나게 되면 문제를 해결하는 의미가 없다. 또한 실제 로봇에 적용하게되면 모든 로봇들은 각 단위시간마다 노드에서 정지해서 움직여야 하기 때문에 시간이 너무 오래 걸리게 된다.

이러한 문제들을 해결하기 위해 우리 팀에서는 CBS의 하위 레벨을 탐색 할 때 로봇의 키네마틱스와 충돌 폴리곤을 이용해 연속시간 도메인에서 각 노드에 도착하게되는 시간을 구하고, 이를 바탕으로 상위 레벨탐색에서 충돌을 검사하였다.
<br>

# 연속시간 도메인 SIPP(Safe Interval Path Planner)

<br>

# 폴리곤 기반 Conflict Detecting
실제 현장에서는 로봇이 그리드 내부에 완벽하게 들어가지 않기 때문에 연속시간 도메인 SIPP에 더불어 폴리곤 기반 Conflict Detecting 모듈을 만들어 제약 조건을 생성해야 했다.

1. 로봇 2대 선택
2. 각 로봇에게 주어진 경로를 기반으로 시간 기반 로봇 위치 벡터(x,y,w) 리스트 생성
3. 충돌 얘측 시간 동안의 로봇 위치 벡터와 로봇 충돌 범위 상대 좌표를 이용하여 충돌 확인 및 충돌 시점 체크. 